# ON-PREM KUBERNETES INSTALLATION TOOLS:

## RKE [link](https://github.com/rancher/rke) vs EPIPHANY [link](https://github.com/epiphany-platform/epiphany)

| Feature                                  | RKE                | RKE - description  | Epiphany           | Epiphany - description    |
| ---------------------------------------- | ------------------ | -------------------| ------------------ | ------------------------- |
| Opensource project                       | :white_check_mark: | https://github.com/rancher/rke | :white_check_mark: | https://github.com/epiphany-platform/epiphany |
| Upscale worker and control plane nodes   | :white_check_mark: | -                  | :white_check_mark: | -                         |
| Downscale worker and control plane nodes | :white_check_mark: | https://rancher.com/docs/rke/latest/en/managing-clusters/ | :x: | - |
| Installation approach                    | Hypercube | Single binary file which contains all set of core Kubernetes components, e.g. API, Scheduler, Controller, etc. The problem with this approach is that bug-fix for API causes update of all core Kubernetes containers. Only single endpoint to download the binary. Kubernetes components as Docker containers - also kubelet. | Kubeadm | Kubeadm installer. On all nodes we need to install kubelet, kubeadm, Docker, kubectl and kubernetes-cni from the Kubernetes upstream repositories. Officially developed and supported by Kubenetes developers. |
| Support Single Node mode                 | :white_check_mark: | -                  | :white_check_mark: | - |
| Support HA-mode                          | :white_check_mark: | https://rancher.com/docs/rancher/v2.x/en/installation/resources/k8s-tutorials/ha-rke/<br />By default the kubelets and kube-proxies are configured to connect to nginx-proxy service that proxies all requests to all master nodes | :white_check_mark: | https://github.com/epiphany-platform/epiphany/blob/develop/docs/design-docs/kubernetes-ha/kubernetes-ha.md<br /> Based on idea from kubespray HA-mode, on every node lightweight load-balancer is installed that proxies all requests to all master nodes |
| Possible container runtimes              | :white_check_mark: | Docker | :white_check_mark: | Docker |
| Cluster state file                       | :white_check_mark: | State file is create by default what can be very useful in case of module approach | :x: | - |
| Simplicity                               | :white_check_mark: | Own solution for setting up a cluster based on the GO language | :x: | Complex solution for setting up a cluster based on python language, ansible tool (stateless) and kubeadm |
| Kubeconfig extracted automatically       | :white_check_mark: | Kubeconfig is automatically generated for the RKE cluster in local directory | :x: | Only for installation process |
| Up-to-date K8s version                   | :white_check_mark: | The latest version of K8s with a slight delay | :x: | Usually two minor version behind the upstream version |
| Certificate Management                   | :white_check_mark: | - Default certificates are valid for 10 years<br /> - Possible to use custom certificates<br /> - RKE has a rke cert command and it is possible to easily rotate the certificates | :white_check_mark: | - Default certificates are valid for 1 year (possible to set custom value)<br /> - Possible to use custom CA certificates<br /> - Epiphany has a ability to renew the certificates |
| Offline mode                             | :x: | Airgapped supported, offline not fully supported, we need to provide private Docker registry and the list of required docker images can be easily obtained | :white_check_mark: | - |
| Fast upgrade                             | :white_check_mark: | ~100% faster upgrade than in Epiphany<br /> Comparison made on the basis of cluster with 3 master nodes in HA-mode and 3 worker nodes  | :x: | ~100% longer upgrade than in RKE<br /> Comparison made on the basis of cluster with 3 master nodes in HA-mode and 3 worker nodes |
| Fast installation                        | :white_check_mark: | ~100% faster installation than in Epiphany<br /> Comparison made on the basis of cluster with 3 master nodes in HA-mode and 3 worker nodes using custom repository feature in Epiphany. Without using the feature, the difference will be even much more bigger. | :x: | ~100% longer installation than in RKE<br /> Comparison made on the basis of cluster with 3 master nodes in HA-mode and 3 worker nodes using custom repository feature in Epiphany. Without using the feature, the difference will be even much more bigger. |
| Zero downtime upgrade                    | :white_check_mark: | Only when the cluster requirements are meet: https://rancher.com/docs/rke/latest/en/upgrades/maintaining-availability/#2-cluster-requirements | :white_check_mark: | Only when the cluster requirements are meet: https://github.com/epiphany-platform/epiphany/blob/develop/docs/home/howto/UPGRADE.md |
| CNI network plugin supported             | :white_check_mark: | Flannel, Calico, Canal (by default), Weave | :white_check_mark: | Flannel, Calico, Canal |
| Customizability                          | :x: | Limited by RKE project | :white_check_mark: | Totally customizable |
| Cost                                     | :white_check_mark: | Lower | :x: | Higher - Epiphany team need to mantain all the code and upgrades
| CNCF Certification                       | :white_check_mark: | Every release supports the same APIs as upstream Kubernetes | :white_check_mark: | Every release supports the same APIs as upstream Kubernetes |
| Installation is idempotent               | :white_check_mark: | - | :white_check_mark: | - |
| Hardening                                | :white_check_mark: | - Network plugin requirements done by default ( IP forwarding, bridge-nf-call tables etc..)<br /> - Admission-plugins enabled by default<br /> - Audit logs enabled by default<br /> All the defaults of kubernetes services can be changed using the extra_args in config file. | :white_check_mark: | <br /> - All the hardening (IP forwarding, bridge-nf-call tables etc..) is done by default and mantain by Epiphany Team using usually ansible modules<br /> - Audit logs enabled by default<br /> - Admission-plugins enabled by default<br /> All the defaults of kubernetes services can be changed using parameters in config file. |
| DNS providers                            | :white_check_mark: | - CoreDNS as default but possible to use kube-dns<br /> - Host plugin can be added to config map using addons and yml file | :white_check_mark: | CoreDNS as default | - Config map is updated by default with host plugin using ansible and kubectl |
| Encrypting Secret Data at Rest           | :white_check_mark: | Disabled by default but it can be enabled easily | :white_check_mark: | Enabled by default, can be easily disbaled |
| Backups and disaster recovery            | :white_check_mark: | - Can be configured to automatically take snapshots of etcd<br /> - Restore can be done using rke etcd snapshot-restore command <br /> - Snapshots are always saved locally in /opt/rke/etcd-snapshots <br /> - Possible to upload snapshots to Amazon S3 backend | :white_check_mark: | - Can be done using epicli backup command<br /> - Default backup location is defined on repository host<br /> - Possible backend storage for snapshots: Azure Blob Storage, Amazon S3, NAS and any other attached storage<br /> Restore can be done using epicli recovery command |
| Maintenance                              | :white_check_mark: | - 73 contributors<br /> Last month:<br /> - 8 authors of commits<br /> - 32 active PR<br /> - 26 merged PR<br /> - 13 releases | :white_check_mark: | - 23 contributors<br /> Last month:<br /> - 6 authors of commits<br /> - 36 active PR<br /> - 29 merged PR<br /> - 1 release |
| Troubleshooting                          | :white_check_mark: | - 153 open issues<br /> Last month:<br /> - 24 active issues<br /> - 14 closed issues | :white_check_mark: | - 298 open issues<br /> Last month:<br /> - 43 active issues<br /> - 18 closed issues |
| Documentation                            | :white_check_mark: | https://rancher.com/docs/rke/latest/en/ | :white_check_mark: | https://github.com/epiphany-platform/epiphany |


What we still need to compare more deeply: 

- Maintenance, Troubleshooting
- Migration of existing products
- Air-gapped/Offline mode ( done? )